// Code generated by format-engine. DO NOT EDIT.

package {{.LCName}}

import "reflect"

// Marshaller is the interface implemented by types that can marshal themselves into valid {{.UCName}}.
type Marshaller interface {
	Marshal{{.UCName}}() ([]byte, error)
}

var marshaller = reflect.TypeOf((*Marshaller)(nil)).Elem()

// IsMarshaller attempts to cast the value to {{.UCName}} Marshaller interface,
// if so, returns a marshal function.
func (t tag) IsMarshaller(rv reflect.Value) (func() ([]byte, error), bool) {
	// If we have a non-pointer value whose type implements Marshaller with a value receiver,
	// then we're better off taking the address of the value - otherwise we end up with an
	// allocation as we cast the value to an interface.
	if rv.Kind() != reflect.Pointer && reflect.PointerTo(rv.Type()).Implements(marshaller) {
		tmp := reflect.ValueOf(rv.Interface())
		rv = reflect.New(rv.Type())
		rv.Elem().Set(tmp)
	}

	if i, ok := rv.Interface().(Marshaller); ok {
		return i.Marshal{{.UCName}}, ok
	}

	return nil, false
}

// Unmarshaler is the interface implemented by types that can unmarshal {{.UCName}} description of themselves.
type Unmarshaler interface {
	Unmarshal{{.UCName}}([]byte) error
}

// IsUnmarshaler attempts to cast the value to {{.UCName}} Unmarshaler interface,
// if so, returns an unmarshal function.
func (t tag) IsUnmarshaler(rv reflect.Value) (func([]byte) error, bool) {
	if i, ok := rv.Interface().(Unmarshaler); ok {
		return i.Unmarshal{{.UCName}}, ok
	}

	return nil, false
}
